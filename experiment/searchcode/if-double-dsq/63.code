double fcr = -1.;
double gcr = -1.;
if (det != 0.0) {

double rx = xc - xa;  // ******* error - was xd - xa
double dsq = distance2(xyxy[0], xyxy[1], xyxy[2], xyxy[3]);

double ret = 0.;
if (Math.abs(d1q-d2q) < dsq) {
// its an acute angled triangle;

