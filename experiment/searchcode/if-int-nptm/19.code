final int nptm = npt - np;
final int nh = n * np / 2;

final ArrayRealVector work1 = new ArrayRealVector(n);
for (int j = 0; j < n; j++) {
for (int i = 0; i <= j; i++) {
if (i < j) {

