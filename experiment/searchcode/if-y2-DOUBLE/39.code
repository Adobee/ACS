final double[] y2 = new double[x.length];
final double[] u = new double[x.length];
if (null == yp1) {
y2[0] = 0.0;
final double y2 = i == xs.length - 1 ? ys[i] : ys[j];
final double xd = x2 - x1;
final double yd = y2 - y1;
if (xd == 0.0) {

